<script>
  const Utils = {}

  Utils.request = async (functionName, params={}) => {
    params = JSON.stringify(params)
    return new Promise((resolve, reject) => {
      google.script.run
        .withSuccessHandler((response) => resolve(JSON.parse(response)))
        .withFailureHandler((err) => reject(err))
        [functionName](params)
    })
  }
</script>
